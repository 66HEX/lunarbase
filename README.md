# IronBase

**üî• A production-ready Backend-as-a-Service (BaaS) built with Rust**

IronBase is a high-performance, secure backend solution inspired by PocketBase, built from the ground up using Rust with Axum, SQLite, and Diesel ORM. Designed to provide developers with a fast, reliable, and easy-to-use backend for web and mobile applications.

## üöÄ Current Status

IronBase is actively under development with **Phase 3** completed. The foundation, authentication system, and dynamic collections are production-ready.

### ‚úÖ **Completed Features**

#### üèóÔ∏è **Phase 1: Foundation** 
- [x] **Modular Architecture** - Clean separation of concerns with proper folder structure
- [x] **Database Layer** - SQLite with Diesel ORM and connection pooling
- [x] **HTTP Server** - Axum-based server with routing and middleware
- [x] **Health Monitoring** - Health check endpoint with status reporting
- [x] **Graceful Shutdown** - Proper signal handling for production deployments
- [x] **Logging & Tracing** - Structured logging with request tracing
- [x] **CORS Support** - Cross-origin resource sharing configuration

#### üîê **Phase 2: Authentication & Security**
- [x] **User Management** - Complete user model with validation
- [x] **Secure Authentication** - Production-grade auth system with:
  - **Argon2 Password Hashing** - Industry-standard password security
  - **JWT Tokens** - Short-lived access tokens (15min) + refresh tokens (7 days)
  - **Account Security** - Account lockout after failed attempts
  - **Timing Attack Protection** - Constant-time operations for security
  - **Rate Limiting** - Request throttling to prevent abuse
  - **Input Validation** - Comprehensive request sanitization
- [x] **API Endpoints**:
  - `POST /api/auth/register` - User registration
  - `POST /api/auth/login` - User authentication  
  - `POST /api/auth/refresh` - Token refresh
  - `GET /api/auth/me` - Protected user profile
- [x] **Security Middleware** - Request validation and token verification
- [x] **Error Handling** - Production-safe error responses (no data leakage)

#### üóÉÔ∏è **Phase 3: Dynamic Collections System**
- [x] **Dynamic Table Creation** - Each collection gets its own SQL table (not JSON storage)
- [x] **Production-Ready Schema Management** - Field types mapped to native SQL columns
- [x] **Full CRUD Operations** - Create, read, update, delete collections and records
- [x] **Advanced Type System** - 9 field types with proper validation:
  - **Text** - String fields with length validation
  - **Number** - Integer/float with automatic type detection
  - **Boolean** - True/false values
  - **Date** - Timestamp fields
  - **Email** - Email validation
  - **URL** - URL validation  
  - **JSON** - Structured data storage
  - **File** - File references
  - **Relation** - Inter-collection relationships
- [x] **Query Engine** - Filtering, sorting, and pagination for records
- [x] **Field Validation** - Schema enforcement with custom rules
- [x] **SQL Performance** - Native SQL queries with proper indexing
- [x] **Collections API**:
  - `GET /api/collections` - List all collections
  - `POST /api/collections` - Create new collection (admin only)
  - `GET /api/collections/{name}` - Get collection details
  - `PUT /api/collections/{name}` - Update collection (admin only)
  - `DELETE /api/collections/{name}` - Delete collection (admin only)
  - `GET /api/collections/{name}/records` - List records
  - `POST /api/collections/{name}/records` - Create record
  - `GET /api/collections/{name}/records/{id}` - Get record
  - `PUT /api/collections/{name}/records/{id}` - Update record
  - `DELETE /api/collections/{name}/records/{id}` - Delete record
- [x] **Comprehensive Testing** - 14/14 tests passing (unit + integration)

### üìä **Technical Stack**

| Component | Technology | Purpose |
|-----------|------------|---------|
| **Runtime** | Rust + Tokio | High-performance async runtime |
| **Web Framework** | Axum | Modern, fast HTTP server |
| **Database** | SQLite + Diesel | Embedded database with type-safe ORM |
| **Authentication** | JWT + Argon2 | Secure token-based auth |
| **Serialization** | Serde | JSON handling |
| **Logging** | tracing | Structured observability |

### üîß **Getting Started**

#### Prerequisites
- Rust 1.70+ 
- SQLite
- Diesel CLI: `cargo install diesel_cli --no-default-features --features sqlite`

#### Quick Start

```bash
# Clone the repository
git clone <repository-url>
cd ironbase

# Set up the database
diesel migration run

# Run the server
cargo run
```

#### Configuration

Set environment variables or use defaults:

```bash
export DATABASE_URL="db.sqlite"          # Database file path
export SERVER_HOST="127.0.0.1"           # Server bind address  
export SERVER_PORT="3000"                # Server port
export JWT_SECRET="your-secret-key"       # JWT signing secret
```

#### API Usage Examples

**Authentication Examples:**

**Register a new user:**
```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "SecurePass123!",
    "username": "username"
  }'
```

**Login:**
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com", 
    "password": "SecurePass123!"
  }'
```

**Access protected endpoint:**
```bash
curl -X GET http://localhost:3000/api/auth/me \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

**Collections API Examples:**

**Create a collection (admin only):**
```bash
curl -X POST http://localhost:3000/api/collections \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -d '{
    "name": "articles",
    "display_name": "Blog Articles",
    "description": "Collection for blog posts",
    "schema": {
      "fields": [
        {
          "name": "title",
          "field_type": "text",
          "required": true,
          "validation": {
            "max_length": 100
          }
        },
        {
          "name": "content",
          "field_type": "text",
          "required": false
        },
        {
          "name": "published",
          "field_type": "boolean",
          "required": false,
          "default_value": false
        },
        {
          "name": "views",
          "field_type": "number",
          "required": false,
          "default_value": 0
        }
      ]
    }
  }'
```

**Create a record:**
```bash
curl -X POST http://localhost:3000/api/collections/articles/records \
  -H "Content-Type: application/json" \
  -d '{
    "data": {
      "title": "My First Article",
      "content": "This is the content of my first article.",
      "published": true,
      "views": 42
    }
  }'
```

**Get all collections:**
```bash
curl -X GET http://localhost:3000/api/collections
```

**Get records with pagination:**
```bash
curl -X GET "http://localhost:3000/api/collections/articles/records?limit=10&offset=0"
```

**Update a record:**
```bash
curl -X PUT http://localhost:3000/api/collections/articles/records/1 \
  -H "Content-Type: application/json" \
  -d '{
    "data": {
      "title": "Updated Title",
      "views": 100
    }
  }'
```

## üéØ **Roadmap & TODOs**

### üîÑ **Phase 4: Real-time & Files** (Next)
- [ ] **Real-time Subscriptions** - WebSocket-based live data updates
- [ ] **File Management** - Upload, storage, and serving of files
- [ ] **Advanced Queries** - Complex filtering with operators (gt, lt, contains, etc.)
- [ ] **Bulk Operations** - Batch create/update/delete operations
- [ ] **Data Import/Export** - CSV/JSON data migration tools

### üé® **Phase 5: Admin Dashboard**
- [ ] **Web Interface** - React-based administration panel
- [ ] **User Management** - Admin interface for user operations
- [ ] **Collection Builder** - Visual collection schema designer
- [ ] **Analytics Dashboard** - Usage statistics and monitoring
- [ ] **Settings Management** - Configuration via web interface
- [ ] **Backup & Restore** - Data management tools

### üìö **Phase 6: SDK & Documentation**
- [ ] **JavaScript SDK** - Client library for web applications
- [ ] **TypeScript Definitions** - Full type safety for TS projects
- [ ] **API Documentation** - Interactive OpenAPI/Swagger docs
- [ ] **Integration Guides** - Framework-specific tutorials
- [ ] **Examples Repository** - Sample applications and use cases

### ‚ö° **Phase 7: Performance & Production**
- [ ] **Horizontal Scaling** - Multi-instance deployment support
- [ ] **PostgreSQL Support** - Alternative to SQLite for larger deployments
- [ ] **Caching Layer** - Redis integration for performance
- [ ] **Monitoring & Metrics** - Prometheus/Grafana integration
- [ ] **Docker Support** - Containerization for easy deployment
- [ ] **Load Testing** - Performance benchmarks and optimization

### üîí **Future Security Enhancements**
- [ ] **OAuth2 Integration** - Social login providers
- [ ] **2FA Support** - Two-factor authentication
- [ ] **API Keys** - Service-to-service authentication
- [ ] **Role-based Permissions** - Fine-grained access control
- [ ] **Audit Logging** - Security event tracking
- [ ] **Session Management** - Advanced session controls

## üèóÔ∏è **Architecture**

```
ironbase/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/          # Application configuration
‚îÇ   ‚îú‚îÄ‚îÄ database/        # Database connection and pooling
‚îÇ   ‚îú‚îÄ‚îÄ handlers/        # HTTP request handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.rs      # Authentication endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ collections.rs # Collections API endpoints
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.rs    # Health check endpoint
‚îÇ   ‚îú‚îÄ‚îÄ middleware/      # HTTP middleware
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.rs      # Authentication & rate limiting
‚îÇ   ‚îú‚îÄ‚îÄ models/          # Database models and DTOs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.rs      # User model with validation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ collection.rs # Collection & record models
‚îÇ   ‚îú‚îÄ‚îÄ services/        # Business logic layer
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ collection_service.rs # Collections operations
‚îÇ   ‚îú‚îÄ‚îÄ utils/           # Shared utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_error.rs # Error handling
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jwt_service.rs # JWT token management
‚îÇ   ‚îú‚îÄ‚îÄ schema.rs        # Diesel database schema
‚îÇ   ‚îî‚îÄ‚îÄ main.rs          # Application entry point
‚îú‚îÄ‚îÄ migrations/          # Database migrations
‚îî‚îÄ‚îÄ Cargo.toml          # Dependencies and metadata
```

### üóÑÔ∏è **Dynamic Collections Architecture**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                IRONBASE COLLECTIONS SYSTEM                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Collection: "articles"                                      ‚îÇ
‚îÇ SQL Table: records_articles                                 ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ id | title | content | published | views | created_at  ‚îÇ ‚îÇ
‚îÇ ‚îÇ 1  | "..."  | "..."   | TRUE     | 42    | 2024-01-01 ‚îÇ ‚îÇ
‚îÇ ‚îÇ 2  | "..."  | "..."   | FALSE    | 156   | 2024-01-02 ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Collection: "products"                                      ‚îÇ
‚îÇ SQL Table: records_products                                 ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ id | name | price | stock | category | created_at      ‚îÇ ‚îÇ
‚îÇ ‚îÇ 1  | "..." | 29.99 | 100   | "tech"  | 2024-01-01     ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Metadata Table: collections                                 ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ id | name      | schema_json | created_at              ‚îÇ ‚îÇ
‚îÇ ‚îÇ 1  | articles  | {...}       | 2024-01-01             ‚îÇ ‚îÇ
‚îÇ ‚îÇ 2  | products  | {...}       | 2024-01-01             ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üõ°Ô∏è **Security Features**

- **Password Security**: Argon2 hashing with secure salt generation
- **Token Management**: JWT with automatic rotation and expiration  
- **Rate Limiting**: Protection against brute force attacks
- **Input Validation**: Comprehensive request sanitization
- **Timing Attack Prevention**: Constant-time operations
- **Account Protection**: Automatic lockout after failed attempts
- **Secure Headers**: CORS and security middleware
- **Error Safety**: No sensitive data leakage in responses
- **SQL Injection Protection**: All dynamic queries properly escaped
- **Schema Validation**: Strict type checking and field validation
- **Access Control**: Admin-only collection management, public read access

## üß™ **Testing**

```bash
# Run all tests (unit + integration)
cargo test -- --test-threads=1

# Run only unit tests
cargo test --lib

# Run only integration tests
cargo test --test collections_integration_tests

# Check code formatting
cargo fmt --check

# Run linter
cargo clippy
```

### üìä **Test Coverage**

- **Unit Tests**: 4/4 passing (Collection service business logic)
- **Integration Tests**: 10/10 passing (Full HTTP API testing)
- **Total Coverage**: 14/14 tests passing
- **Test Categories**:
  - Authentication flow
  - Collection CRUD operations
  - Record CRUD operations
  - Schema validation
  - Error handling
  - Security (unauthorized access)
  - Data type validation

## üìà **Performance**

IronBase is built for performance:
- **Rust's Zero-Cost Abstractions** - Maximum efficiency
- **Async/Await** - Non-blocking I/O for high concurrency
- **Connection Pooling** - Efficient database access
- **Minimal Dependencies** - Fast compilation and small binary size

## ü§ù **Contributing**

We welcome contributions! Please see our contributing guidelines for details on:
- Code style and standards
- Testing requirements  
- Pull request process
- Issue reporting

## üìÑ **License**

This project is licensed under the MIT License - see the LICENSE file for details.

## üåü **Why IronBase?**

- **üöÄ Performance**: Built with Rust for maximum speed and efficiency
- **üîí Security**: Production-grade security features built-in
- **üõ†Ô∏è Developer Experience**: Simple API with powerful features
- **üìà Scalable**: Designed to grow with your application
- **üîß Flexible**: Modular architecture for easy customization
- **üéØ Production Ready**: Battle-tested components and patterns

---

**Built with ‚ù§Ô∏è and ‚ö° by the IronBase team** 